
# Анализ и связывание записей пациентов

## Описание проекта

Этот проект использует данные, предоставленные Калифорнийским университетом в Ирвине (UCI), для анализа и связывания записей пациентов. Набор данных содержит миллионы пар записей пациентов, которые были сопоставлены по различным критериям, таким как имя, фамилия, адрес и дата рождения.

Данные были собраны в немецкой больнице в 2010 году. Для каждой пары записей был рассчитан числовой балл (от 0,0 до 1,0), который указывает на степень схожести этих записей. Для защиты конфиденциальности пациентов были удалены базовые значения полей.


### Пример данных

+-------+-------+-----------------+------------+------------+------------+-------+------+------+------+-------+--------+
|   id_1|   id_2|     cmp_fname_c1|cmp_fname_c2|cmp_lname_c1|cmp_lname_c2|cmp_sex|cmp_bd|cmp_bm|cmp_by|cmp_plz|is_match|
+-------+-------+-----------------+------------+------------+------------+-------+------+------+------+-------+--------+
|37291.0|53113.0|0.833333333333333|        NULL|         1.0|        NULL|    1.0|   1.0|   1.0|   1.0|    0.0|    true|
|39086.0|47614.0|              1.0|        NULL|         1.0|        NULL|    1.0|   1.0|   1.0|   1.0|    1.0|    true|
|70031.0|70237.0|              1.0|        NULL|         1.0|        NULL|    1.0|   1.0|   1.0|   1.0|    1.0|    true|
|84795.0|97439.0|              1.0|        NULL|         1.0|        NULL|    1.0|   1.0|   1.0|   1.0|    1.0|    true|
|36950.0|42116.0|              1.0|        NULL|         1.0|         1.0|    1.0|   1.0|   1.0|   1.0|    1.0|    true|
+-------+-------+-----------------+------------+------------+------------+-------+------+------+------+-------+--------+

## Связывание записей

Задача связывания записей в общем виде выглядит примерно так: у нас есть большая коллекция записей из одной или нескольких исходных систем, и вполне вероятно, что несколько записей относятся к одному и тому же базовому объекту, такому как клиент, пациент, место проведения мероприятия или само мероприятие. Каждая сущность имеет ряд атрибутов, таких, как имя, адрес или день рождения, и нам нужно будет использовать эти атрибуты, чтобы найти записи, относящиеся к одной и той же сущности. К сожалению, значения этих атрибутов не идеальны: они могут иметь различное форматирование, опечатки или отсутствующую информацию, а это означает, что простая проверка на совпадение значений атрибутов приведет к тому, что мы пропустим значительное количество повторяющихся записей. 

### Пример связывания записей

| Название                   | Адрес                     | Город         | Штат       | Телефон      |
|----------------------------|---------------------------|---------------|------------|--------------|
| Josh's Coffee Shop         | 1234 Sunset Boulevard     | West Hollywood| CA         | (213)-555-1212|
| Josh Coffee                | 1234 Sunset Blvd West     | Hollywood     | CA         | 555-1212     |
| Coffee Chain #1234         | 1400 Sunset Blvd #2       | Hollywood     | CA         | 206-555-1212 |
| Coffee Chain Regional Office| 1400 Sunset Blvd Suite 2 | Hollywood     | California | 206-555-1212 |

### Анализ

Первые две записи в этой таблице относятся к одной и той же небольшой кофейне, хотя из-за ошибки ввода данных кажется, что они находятся в двух разных городах (Западном Голливуде и Голливуде). Вторые две записи, напротив, на самом деле относятся к разным офисам одной и той же сети кофеен, которые имеют общий адрес: одна из записей относится к кофейне, а другая относится к местному корпоративному офису, который находится в том же здании. В обеих записях указан официальный номер телефона штаб-квартиры корпорации в Сиэтле.
Этот пример иллюстрирует все, что делает связывание записей таким сложным: хотя записи в обеих парах выглядят похожими друг на друга, критерии, которые мы используем для принятия решения о наличии или отсутствии дублирования, уникальные для каждой пары. Это различие из числа тех, которые легко обнаруживаются и распознаются человеком, но очень плохо даются компьютеру.
Связывание записей имеет много разных названий в литературе и на практике: разрешение сущностей, дедупликация записей, слияние и очистка, промывка списков

## Использование

Этот проект включает Jupyter Notebook с анализом данных и примером использования для связывания записей.

1. Клонируйте репозиторий:
    ```sh
    git clone https://github.com/Konstagit/PySpark_project.git
    ```
2. Перейдите в директорию проекта:
    ```sh
    cd PySpark_project
    ```
3. Установите зависимости:
    ```sh
    pip install -r requirements.txt
    ```
4. Запустите Jupyter Notebook:
    ```sh
    python -m notebook code.ipynb
    ```

## Требования

- Python 3.6+
- Jupyter Notebook
- Pandas
- NumPy
- PySpark (если используется)

## Лицензия

Этот проект лиспользует открыую лицензию.

## Контакты

Konstagit  
Email: [konstantinovpavelgit@gmail.com](mailto:konstantinovpavelgit@gmail.com)
